name: Driving Licence CRI Stub - Secure Pipeline build, push & Ship
on:
  workflow_dispatch:
  workflow_call:

jobs:
  dockerBuildAndPush:
    uses: ./.github/workflows/cri-stub-build-and-push.yml
    permissions:
      id-token: write
      contents: read
      packages: read
    with:
      WORKING_DIRECTORY: ./di-ipv-credential-issuer-stub/deploy/driving-licence
    secrets:
      ARTIFACT_BUCKET_NAME: ${{ secrets.CRI_DRV_LICENCE_ARTIFACT_BUCKET_NAME }}
      CONTAINER_SIGN_KMS_KEY: ${{ secrets.CONTAINER_SIGN_KMS_KEY }}
      DYNATRACE_PAAS_TOKEN: ${{ secrets.DYNATRACE_PAAS_TOKEN }}
      ECR_REPOSITORY: ${{ secrets.CRI_DRV_LICENCE_ECR_REPOSITORY }}
      GH_ACTIONS_ROLE_ARN: ${{ secrets.CRI_DRV_LICENCE_GH_ACTIONS_ROLE_ARN }}
